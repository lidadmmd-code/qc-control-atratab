<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒ Ø³Ù…Ù¾Ù„Ø±â€ŒÙ‡Ø§ - Ø´Ø±Ú©Øª Ø¢ØªØ±Ø§ Ø·Ø¨ Ù‚ÙˆÙ…Ø³</title>
    <style>
        * {
            font-family: 'B Nazanin', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 15px;
            color: #2c3e50;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1250px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            padding: 0;
            overflow: hidden;
        }
        
        /* Ù‡Ø¯Ø± Ø´Ø±Ú©Øª */
        .company-header {
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            color: white;
            padding: 25px 30px;
            text-align: center;
            border-bottom: 4px solid #ff6b35;
            position: relative;
            overflow: hidden;
        }
        
        .company-header::before {
            content: "";
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 25px 25px;
            opacity: 0.15;
            z-index: 0;
        }
        
        .company-name {
            font-size: 30px;
            font-weight: bold;
            letter-spacing: 0.5px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }
        
        .company-subtitle {
            font-size: 19px;
            font-weight: 500;
            opacity: 0.95;
            color: #ffcc80;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }
        
        .company-info {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 25px;
            margin-top: 15px;
            font-size: 14px;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }
        
        .info-item {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.1);
            padding: 6px 12px;
            border-radius: 20px;
            backdrop-filter: blur(5px);
        }
        
        .info-item i {
            color: #ffcc80;
            font-size: 16px;
        }
        
        /* Ø¨Ø®Ø´ ÙØ±Ù… */
        .form-container {
            padding: 25px;
        }
        
        .form-title {
            text-align: center;
            color: #1a237e;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e8eaf6;
            font-size: 22px;
            position: relative;
            font-weight: bold;
        }
        
        .form-title::after {
            content: "";
            position: absolute;
            bottom: -2px;
            right: 50%;
            transform: translateX(50%);
            width: 120px;
            height: 3px;
            background: #ff6b35;
        }
        
        .subtitle {
            text-align: center;
            color: #5c6bc0;
            margin-bottom: 25px;
            font-size: 15px;
        }
        
        .info-box {
            background-color: #f8f9fa;
            border-right: 4px solid #5c6bc0;
            padding: 18px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
        }
        
        .info-box h3 {
            margin-top: 0;
            color: #1a237e;
            font-size: 17px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .info-box h3::before {
            content: "ğŸ“‹";
            font-size: 18px;
        }
        
        .info-box p {
            margin-bottom: 7px;
            color: #444;
            font-size: 14px;
            line-height: 1.8;
        }
        
        .header-section {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 20px;
            background: #f5f7ff;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e1e8ff;
        }
        
        .lab-info {
            display: flex;
            gap: 25px;
            flex-wrap: wrap;
            flex-grow: 1;
        }
        
        .lab-info-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-width: 180px;
        }
        
        .lab-info-item label {
            font-weight: 600;
            color: #1a237e;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .lab-info-item label::before {
            content: "â€¢";
            color: #ff6b35;
            font-size: 18px;
        }
        
        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            font-size: 14px;
            transition: all 0.3s;
            background-color: #fff;
        }
        
        input[type="text"]:focus, input[type="number"]:focus {
            outline: none;
            border-color: #5c6bc0;
            box-shadow: 0 0 0 3px rgba(92, 107, 192, 0.1);
        }
        
        /* Ø¬Ø¯ÙˆÙ„ */
        .table-container {
            overflow-x: auto;
            margin-top: 15px;
            border-radius: 6px;
            border: 1px solid #e1e8ff;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.04);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1050px;
        }
        
        th {
            background: linear-gradient(to bottom, #3f51b5, #303f9f);
            color: white;
            font-weight: 600;
            text-align: center;
            padding: 16px 12px;
            border: 1px solid #3949ab;
            white-space: nowrap;
            font-size: 14px;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        td {
            padding: 13px 10px;
            border: 1px solid #e1e1e1;
            text-align: center;
            vertical-align: middle;
            background-color: #fff;
            font-size: 14px;
        }
        
        tr:nth-child(even) td {
            background-color: #f9fafe;
        }
        
        tr:hover td {
            background-color: #f0f3ff;
        }
        
        .input-cell {
            width: 120px;
        }
        
        .status-cell {
            width: 140px;
            min-width: 140px;
        }
        
        .checkbox-group {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 8px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 7px;
            cursor: pointer;
        }
        
        .checkbox-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
            accent-color: #4caf50;
        }
        
        .checkbox-item span {
            font-size: 13px;
            color: #444;
        }
        
        /* Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ */
        .buttons {
            display: flex;
            gap: 12px;
            margin-top: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-width: 150px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        }
        
        .btn-save {
            background: linear-gradient(to right, #4caf50, #388e3c);
            color: white;
        }
        
        .btn-save:hover {
            background: linear-gradient(to right, #43a047, #2e7d32);
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(76, 175, 80, 0.25);
        }
        
        .btn-print {
            background: linear-gradient(to right, #2196f3, #1565c0);
            color: white;
        }
        
        .btn-print:hover {
            background: linear-gradient(to right, #1976d2, #0d47a1);
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(33, 150, 243, 0.25);
        }
        
        .btn-reset {
            background: linear-gradient(to right, #f44336, #d32f2f);
            color: white;
        }
        
        .btn-reset:hover {
            background: linear-gradient(to right, #e53935, #c62828);
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(244, 67, 54, 0.25);
        }
        
        .btn-export {
            background: linear-gradient(to right, #ff9800, #f57c00);
            color: white;
        }
        
        .btn-export:hover {
            background: linear-gradient(to right, #fb8c00, #ef6c00);
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(255, 152, 0, 0.25);
        }
        
        /* ÙÙˆØªØ± */
        .footer {
            margin-top: 30px;
            text-align: center;
            color: #555;
            font-size: 13px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            background-color: #f8f9ff;
            padding: 20px;
            border-radius: 0 0 10px 10px;
            line-height: 1.8;
        }
        
        .company-details {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        .detail-item {
            display: flex;
            align-items: center;
            gap: 7px;
            color: #444;
        }
        
        .footer-note {
            margin-top: 10px;
            color: #666;
            font-size: 12.5px;
        }
        
        /* Ú†Ø§Ù¾ */
        @media print {
            .company-header {
                background: #1a237e !important;
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }
            
            .buttons, .info-box, .add-row-btn {
                display: none !important;
            }
            
            body {
                background-color: white;
                padding: 5px;
            }
            
            .container {
                box-shadow: none;
                border: 1px solid #ccc;
            }
            
            th {
                background: #3f51b5 !important;
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }
        }
        
        /* Ù…ÙˆØ¨Ø§ÛŒÙ„ */
        @media (max-width: 768px) {
            .form-container {
                padding: 20px 15px;
            }
            
            .company-header {
                padding: 20px 15px;
            }
            
            .company-name {
                font-size: 24px;
            }
            
            .company-subtitle {
                font-size: 16px;
            }
            
            .company-info {
                flex-direction: column;
                gap: 10px;
                align-items: center;
            }
            
            .header-section {
                flex-direction: column;
                align-items: stretch;
            }
            
            .lab-info {
                flex-direction: column;
                gap: 15px;
            }
            
            .lab-info-item {
                min-width: 100%;
            }
            
            th, td {
                padding: 12px 8px;
                font-size: 13px;
            }
            
            button {
                min-width: 130px;
                padding: 10px 18px;
                font-size: 14px;
            }
            
            .buttons {
                gap: 10px;
            }
        }
        
        /* Ø¯Ú©Ù…Ù‡ Ø¬Ø¯ÛŒØ¯ Ø±Ø¯ÛŒÙ */
        .add-row-btn {
            background: linear-gradient(to right, #9c27b0, #7b1fa2);
            color: white;
            padding: 10px 18px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            font-size: 14px;
        }
        
        .add-row-btn:hover {
            background: linear-gradient(to right, #8e24aa, #6a1b9a);
            transform: translateY(-2px);
        }
        
        .delete-row-btn {
            background: none;
            border: none;
            color: #f44336;
            cursor: pointer;
            font-size: 16px;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.2s;
        }
        
        .delete-row-btn:hover {
            background-color: rgba(244, 67, 54, 0.1);
        }
        
        /* Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø±Ø§ÛŒ Ø§Ø¹Ø¯Ø§Ø¯ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ */
        .english-font {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Ù‡Ø¯Ø± Ø´Ø±Ú©Øª Ø¢ØªØ±Ø§ Ø·Ø¨ Ù‚ÙˆÙ…Ø³ -->
        <div class="company-header">
            <h1 class="company-name">Ø´Ø±Ú©Øª Ø¢ØªØ±Ø§ Ø·Ø¨ Ù‚ÙˆÙ…Ø³</h1>
            <div class="company-subtitle">Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒ ØªØ¬Ù‡ÛŒØ²Ø§Øª Ù¾Ø²Ø´Ú©ÛŒ Ùˆ Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡ÛŒ</div>
            
            <div class="company-info">
                <div class="info-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>Ø³Ù…Ù†Ø§Ù† - Ø¨Ù„ÙˆØ§Ø± 17 Ø´Ù‡Ø±ÛŒÙˆØ±ØŒ Ø¬Ù†Ø¨ Ø¯Ø§Ù†Ø´Ú©Ø¯Ù‡ Ø¯Ù†Ø¯Ø§Ù†Ù¾Ø²Ø´Ú©ÛŒØŒ Ù…Ø±Ú©Ø² Ø±Ø´Ø¯ ÙÙ†Ø§ÙˆØ±ÛŒ Ø³Ù„Ø§Ù…Øª</span>
                </div>
                <div class="info-item">
                    <i class="fas fa-phone"></i>
                    <span>0910-032-1022</span>
                </div>
                <div class="info-item">
                    <i class="fas fa-envelope"></i>
                    <span>atra.teb@yahoo.com</span>
                </div>
            </div>
        </div>
        
        <!-- Ø¨Ø®Ø´ Ø§ØµÙ„ÛŒ ÙØ±Ù… -->
        <div class="form-container">
            <h2 class="form-title">ÙØ±Ù… Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒ Ø³Ù…Ù¾Ù„Ø±â€ŒÙ‡Ø§ÛŒ Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡ÛŒ</h2>
            <div class="subtitle">Ø¨Ø±Ø±Ø³ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ùˆ Ú©Ø§Ù„ÛŒØ¨Ø±Ø§Ø³ÛŒÙˆÙ† Ù¾ÛŒÙ¾Øªâ€ŒÙ‡Ø§ (Ø³Ù…Ù¾Ù„Ø±Ù‡Ø§)</div>
            
            <div class="header-section">
                <div class="lab-info">
                    <div class="lab-info-item">
                        <label><i class="fas fa-flask"></i> Ù†Ø§Ù… Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡ / Ø¨Ø®Ø´:</label>
                        <input type="text" id="lab-name" placeholder="Ù†Ø§Ù… Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡ ÛŒØ§ Ø¨Ø®Ø´">
                    </div>
                    <div class="lab-info-item">
                        <label><i class="fas fa-calendar-alt"></i> ØªØ§Ø±ÛŒØ® Ø¨Ø±Ø±Ø³ÛŒ:</label>
                        <input type="text" id="check-date" placeholder="1403/05/15" value="">
                    </div>
                    <div class="lab-info-item">
                        <label><i class="fas fa-user-md"></i> Ù…Ø³Ø¦ÙˆÙ„ Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒ:</label>
                        <input type="text" id="qc-officer" placeholder="Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ">
                    </div>
                    <div class="lab-info-item">
                        <label><i class="fas fa-id-badge"></i> Ø´Ù…Ø§Ø±Ù‡ Ú¯Ø²Ø§Ø±Ø´:</label>
                        <input type="text" id="report-number" placeholder="QC-1403-001" value="QC-1403-001">
                    </div>
                </div>
            </div>
            
            <div class="info-box">
                <h3>Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ÙØ±Ù… Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒ</h3>
                <p>1. Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù‡Ø± Ø³Ù…Ù¾Ù„Ø± Ø±Ø§ Ø¯Ø± Ø±Ø¯ÛŒÙ Ù…Ø±Ø¨ÙˆØ·Ù‡ ÙˆØ§Ø±Ø¯ Ù†Ù…Ø§ÛŒÛŒØ¯.</p>
                <p>2. Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† ÙˆØ²Ù† Ø¢Ø¨ ØªÙˆØ²ÛŒÙ† Ø´Ø¯Ù‡ (Ù…ÛŒÙ„ÛŒâ€ŒÚ¯Ø±Ù…) Ø±Ø§ Ø«Ø¨Øª Ú©Ù†ÛŒØ¯. Ø­Ø¬Ù… Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</p>
                <p>3. Ù…Ù‚Ø§Ø¯ÛŒØ± Ø¯Ù‚Øª (CV%) Ùˆ ØµØ­Øª (Ø§Ù†Ø­Ø±Ø§Ù%) Ø±Ø§ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ùˆ ÙˆØ§Ø±Ø¯ Ù†Ù…Ø§ÛŒÛŒØ¯.</p>
                <p>4. ÙˆØ¶Ø¹ÛŒØª Ø³Ù…Ù¾Ù„Ø± Ø¨Ø§ ØªÙˆØ¬Ù‡ Ø¨Ù‡ Ø­Ø¯ÙˆØ¯ Ù…Ø¬Ø§Ø² Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ø±Ø±Ø³ÛŒ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯.</p>
                <p>5. Ù¾Ø³ Ø§Ø² ØªÚ©Ù…ÛŒÙ„ Ø§Ø·Ù„Ø§Ø¹Ø§ØªØŒ ÙØ±Ù… Ø±Ø§ Ø°Ø®ÛŒØ±Ù‡ ÛŒØ§ Ú†Ø§Ù¾ Ù†Ù…Ø§ÛŒÛŒØ¯.</p>
            </div>
            
            <div class="table-container">
                <table id="qc-table">
                    <thead>
                        <tr>
                            <th>Ø±Ø¯ÛŒÙ</th>
                            <th>Ø³Ø±ÛŒØ§Ù„ Ùˆ Ù…Ø¯Ù„ Ø³Ù…Ù¾Ù„Ø±</th>
                            <th>Ø´Ù…Ø§Ø±Ù‡ Ø§Ù…ÙˆØ§Ù„</th>
                            <th>Ø­Ø¬Ù… Ù†Ø§Ù…ÛŒ (Âµl)</th>
                            <th>ÙˆØ²Ù† Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø¢Ø¨ (mg)</th>
                            <th>Ø­Ø¬Ù… Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒØ´Ø¯Ù‡ (Âµl)</th>
                            <th>Ø¯Ù‚Øª (CV%)</th>
                            <th>ØµØ­Øª (Ø§Ù†Ø­Ø±Ø§Ù%)</th>
                            <th>ÙˆØ¶Ø¹ÛŒØª Ù†Ù‡Ø§ÛŒÛŒ</th>
                            <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
                        </tr>
                    </thead>
                    <tbody id="table-body">
                        <!-- Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ù¾ÙˆÛŒØ§ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                    </tbody>
                </table>
                <button type="button" class="add-row-btn" onclick="addNewRow()">
                    <i class="fas fa-plus-circle"></i> Ø§ÙØ²ÙˆØ¯Ù† Ø±Ø¯ÛŒÙ Ø¬Ø¯ÛŒØ¯
                </button>
            </div>
            
            <div class="buttons">
                <button class="btn-save" onclick="saveData()">
                    <i class="fas fa-save"></i> Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª
                </button>
                <button class="btn-print" onclick="window.print()">
                    <i class="fas fa-print"></i> Ú†Ø§Ù¾ ÙØ±Ù…
                </button>
                <button class="btn-export" onclick="exportToExcel()">
                    <i class="fas fa-file-excel"></i> Ø®Ø±ÙˆØ¬ÛŒ Excel
                </button>
                <button class="btn-reset" onclick="resetForm()">
                    <i class="fas fa-redo"></i> Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙØ±Ù…
                </button>
            </div>
        </div>
        
        <!-- ÙÙˆØªØ± -->
        <div class="footer">
            <div class="company-details">
                <div class="detail-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>Ø¢Ø¯Ø±Ø³: Ø³Ù…Ù†Ø§Ù† - Ø¨Ù„ÙˆØ§Ø± 17 Ø´Ù‡Ø±ÛŒÙˆØ±ØŒ Ø¬Ù†Ø¨ Ø¯Ø§Ù†Ø´Ú©Ø¯Ù‡ Ø¯Ù†Ø¯Ø§Ù†Ù¾Ø²Ø´Ú©ÛŒØŒ Ù…Ø±Ú©Ø² Ø±Ø´Ø¯ ÙÙ†Ø§ÙˆØ±ÛŒ Ø³Ù„Ø§Ù…Øª</span>
                </div>
                <div class="detail-item">
                    <i class="fas fa-phone"></i>
                    <span>ØªÙ„ÙÙ†: 0910-032-1022</span>
                </div>
                <div class="detail-item">
                    <i class="fas fa-envelope"></i>
                    <span>Ø§ÛŒÙ…ÛŒÙ„: atra.teb@yahoo.com</span>
                </div>
            </div>
            <div class="footer-note">
                Ø§ÛŒÙ† ÙØ±Ù… Ø¬Ù‡Øª Ú©Ù†ØªØ±Ù„ Ø¯ÙˆØ±Ù‡â€ŒØ§ÛŒ Ú©ÛŒÙÛŒ Ø³Ù…Ù¾Ù„Ø±â€ŒÙ‡Ø§ÛŒ Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡ÛŒ Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª. ØªÙˆØµÛŒÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒ Ù‡Ø± Û¶ Ù…Ø§Ù‡ ÛŒÚ©Ø¨Ø§Ø± Ø§Ù†Ø¬Ø§Ù… Ø´ÙˆØ¯.<br>
                ÙØ±Ù…Øª Ú¯Ø²Ø§Ø±Ø´: Ø´Ø±Ú©Øª Ø¢ØªØ±Ø§ Ø·Ø¨ Ù‚ÙˆÙ…Ø³ - Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒ ØªØ¬Ù‡ÛŒØ²Ø§Øª Ù¾Ø²Ø´Ú©ÛŒ Ùˆ Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡ÛŒ
            </div>
        </div>
    </div>

    <script>
        // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        let rowCounter = 1;
        
        // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ ÛŒÚ© Ø±Ø¯ÛŒÙ Ø¬Ø¯ÛŒØ¯
        function createRow(rowNum) {
            return `
                <tr id="row-${rowNum}">
                    <td class="english-font">${rowNum}</td>
                    <td class="input-cell">
                        <input type="text" class="serial-model" placeholder="SN123 / P200" data-field="serial">
                    </td>
                    <td class="input-cell">
                        <input type="text" class="asset-number english-font" placeholder="AM-245" data-field="asset">
                    </td>
                    <td class="input-cell">
                        <input type="number" class="nominal-volume english-font" placeholder="200" value="200" data-field="nominal" min="1" step="1">
                    </td>
                    <td class="input-cell">
                        <input type="number" class="avg-weight english-font" placeholder="199.5" data-field="weight" min="0" step="0.1">
                    </td>
                    <td class="input-cell">
                        <input type="number" class="calc-volume english-font" placeholder="" readonly data-field="calc">
                    </td>
                    <td>
                        <div style="margin-bottom: 8px;">
                            <input type="number" class="precision-value english-font" placeholder="0.8" step="0.1" data-field="precision" style="margin-bottom: 8px; width: 100%;">
                        </div>
                        <div style="display: flex; align-items: center; gap: 5px; justify-content: center;">
                            <span style="font-size: 11px;">Ø­Ø¯:</span>
                            <input type="number" class="precision-limit english-font" value="1.0" step="0.1" style="width: 60px; font-size: 13px; padding: 4px;">
                            <span style="font-size: 11px;">% â‰¤</span>
                        </div>
                    </td>
                    <td>
                        <div style="margin-bottom: 8px;">
                            <input type="number" class="accuracy-value english-font" placeholder="0.05" step="0.1" data-field="accuracy" style="margin-bottom: 8px; width: 100%;">
                        </div>
                        <div style="display: flex; align-items: center; gap: 5px; justify-content: center;">
                            <span style="font-size: 11px;">Ø­Ø¯:</span>
                            <input type="number" class="accuracy-limit english-font" value="1.0" step="0.1" style="width: 60px; font-size: 13px; padding: 4px;">
                            <span style="font-size: 11px;">% Â±</span>
                        </div>
                    </td>
                    <td class="status-cell">
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" class="precision-check" data-field="precisionOk">
                                <span>Ø¯Ù‚Øª Ù‚Ø§Ø¨Ù„ Ù‚Ø¨ÙˆÙ„</span>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" class="accuracy-check" data-field="accuracyOk">
                                <span>ØµØ­Øª Ù‚Ø§Ø¨Ù„ Ù‚Ø¨ÙˆÙ„</span>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" class="final-status" data-field="finalOk">
                                <span>Ø³Ù…Ù¾Ù„Ø± Ù‚Ø§Ø¨Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡</span>
                            </div>
                        </div>
                    </td>
                    <td>
                        <button type="button" class="delete-row-btn" onclick="deleteRow(${rowNum})" title="Ø­Ø°Ù Ø±Ø¯ÛŒÙ">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `;
        }
        
        // ØªØ§Ø¨Ø¹ Ø§ÙØ²ÙˆØ¯Ù† Ø±Ø¯ÛŒÙ Ø¬Ø¯ÛŒØ¯
        function addNewRow() {
            rowCounter++;
            const tableBody = document.getElementById('table-body');
            tableBody.innerHTML += createRow(rowCounter);
            attachRowEvents(rowCounter);
        }
        
        // ØªØ§Ø¨Ø¹ Ø­Ø°Ù Ø±Ø¯ÛŒÙ
        function deleteRow(rowNum) {
            if (rowCounter > 1) {
                const row = document.getElementById(`row-${rowNum}`);
                if (row) {
                    row.remove();
                    // Ø¨Ù‡ Ø±ÙˆØ² Ø±Ø³Ø§Ù†ÛŒ Ø´Ù…Ø§Ø±Ù‡ Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§
                    updateRowNumbers();
                }
            } else {
                alert("Ø­Ø¯Ø§Ù‚Ù„ Ø¨Ø§ÛŒØ¯ ÛŒÚ© Ø±Ø¯ÛŒÙ Ø¯Ø± Ø¬Ø¯ÙˆÙ„ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯.");
            }
        }
        
        // ØªØ§Ø¨Ø¹ Ø¨Ù‡ Ø±ÙˆØ² Ø±Ø³Ø§Ù†ÛŒ Ø´Ù…Ø§Ø±Ù‡ Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§
        function updateRowNumbers() {
            const rows = document.querySelectorAll('#table-body tr');
            rowCounter = rows.length;
            
            rows.forEach((row, index) => {
                const rowNum = index + 1;
                row.id = `row-${rowNum}`;
                row.cells[0].textContent = rowNum;
                
                // Ø¨Ù‡ Ø±ÙˆØ² Ø±Ø³Ø§Ù†ÛŒ ØªØ§Ø¨Ø¹ Ø­Ø°Ù
                const deleteBtn = row.querySelector('.delete-row-btn');
                if (deleteBtn) {
                    deleteBtn.setAttribute('onclick', `deleteRow(${rowNum})`);
                }
            });
        }
        
        // ØªØ§Ø¨Ø¹ Ø§ØªØµØ§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ Ø¨Ù‡ Ø±Ø¯ÛŒÙ
        function attachRowEvents(rowNum) {
            const row = document.getElementById(`row-${rowNum}`);
            if (!row) return;
            
            const avgWeightInput = row.querySelector('.avg-weight');
            const calcVolumeInput = row.querySelector('.calc-volume');
            const nominalVolumeInput = row.querySelector('.nominal-volume');
            const accuracyValueInput = row.querySelector('.accuracy-value');
            const precisionValueInput = row.querySelector('.precision-value');
            const precisionLimitInput = row.querySelector('.precision-limit');
            const accuracyLimitInput = row.querySelector('.accuracy-limit');
            const precisionCheck = row.querySelector('.precision-check');
            const accuracyCheck = row.querySelector('.accuracy-check');
            const finalStatusCheck = row.querySelector('.final-status');
            
            // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± Ø­Ø¬Ù… Ø¨Ø± Ø§Ø³Ø§Ø³ ÙˆØ²Ù†
            if (avgWeightInput && calcVolumeInput) {
                avgWeightInput.addEventListener('input', function() {
                    const weight = parseFloat(this.value);
                    if (!isNaN(weight) && weight > 0) {
                        // Ø¶Ø±ÛŒØ¨ Z Ø¨Ø±Ø§ÛŒ Ø¢Ø¨ Ø¯Ø± Ø¯Ù…Ø§ÛŒ Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡
                        const zFactor = 1.003;
                        const calculatedVolume = (weight * zFactor).toFixed(1);
                        calcVolumeInput.value = calculatedVolume;
                        
                        // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± ØµØ­Øª
                        if (nominalVolumeInput && nominalVolumeInput.value && accuracyValueInput) {
                            const nominalVolume = parseFloat(nominalVolumeInput.value);
                            const accuracy = ((calculatedVolume - nominalVolume) / nominalVolume * 100).toFixed(2);
                            accuracyValueInput.value = accuracy;
                            checkRowStatus(rowNum);
                        }
                    }
                });
            }
            
            // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± ØµØ­Øª Ø¨Ø§ ØªØºÛŒÛŒØ± Ø­Ø¬Ù… Ù†Ø§Ù…ÛŒ
            if (nominalVolumeInput && accuracyValueInput && calcVolumeInput) {
                nominalVolumeInput.addEventListener('input', function() {
                    const nominalVolume = parseFloat(this.value);
                    const calcVolume = parseFloat(calcVolumeInput.value);
                    
                    if (!isNaN(nominalVolume) && nominalVolume > 0 && !isNaN(calcVolume)) {
                        const accuracy = ((calcVolume - nominalVolume) / nominalVolume * 100).toFixed(2);
                        accuracyValueInput.value = accuracy;
                        checkRowStatus(rowNum);
                    }
                });
            }
            
            // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§ ØªØºÛŒÛŒØ± Ø¯Ù‚Øª
            if (precisionValueInput && precisionLimitInput) {
                precisionValueInput.addEventListener('input', function() {
                    checkRowStatus(rowNum);
                });
                
                precisionLimitInput.addEventListener('input', function() {
                    checkRowStatus(rowNum);
                });
            }
            
            // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§ ØªØºÛŒÛŒØ± ØµØ­Øª
            if (accuracyValueInput && accuracyLimitInput) {
                accuracyValueInput.addEventListener('input', function() {
                    checkRowStatus(rowNum);
                });
                
                accuracyLimitInput.addEventListener('input', function() {
                    checkRowStatus(rowNum);
                });
            }
        }
        
        // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø±Ø¯ÛŒÙ
        function checkRowStatus(rowNum) {
            const row = document.getElementById(`row-${rowNum}`);
            if (!row) return;
            
            const precisionValue = parseFloat(row.querySelector('.precision-value').value);
            const accuracyValue = parseFloat(row.querySelector('.accuracy-value').value);
            const precisionLimit = parseFloat(row.querySelector('.precision-limit').value);
            const accuracyLimit = parseFloat(row.querySelector('.accuracy-limit').value);
            const precisionCheck = row.querySelector('.precision-check');
            const accuracyCheck = row.querySelector('.accuracy-check');
            const finalStatusCheck = row.querySelector('.final-status');
            
            // Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ù‚Øª
            if (!isNaN(precisionValue) && !isNaN(precisionLimit)) {
                precisionCheck.checked = Math.abs(precisionValue) <= precisionLimit;
            } else {
                precisionCheck.checked = false;
            }
            
            // Ø¨Ø±Ø±Ø³ÛŒ ØµØ­Øª
            if (!isNaN(accuracyValue) && !isNaN(accuracyLimit)) {
                accuracyCheck.checked = Math.abs(accuracyValue) <= accuracyLimit;
            } else {
                accuracyCheck.checked = false;
            }
            
            // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ù†Ù‡Ø§ÛŒÛŒ
            finalStatusCheck.checked = precisionCheck.checked && accuracyCheck.checked;
            
            // ØªØºÛŒÛŒØ± Ø±Ù†Ú¯ Ø±Ø¯ÛŒÙ Ø¨Ø± Ø§Ø³Ø§Ø³ ÙˆØ¶Ø¹ÛŒØª
            if (finalStatusCheck.checked) {
                row.style.backgroundColor = '#f0fff4';
            } else {
                row.style.backgroundColor = '';
            }
        }
        
        // ØªØ§Ø¨Ø¹ Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª
        function saveData() {
            const labName = document.getElementById('lab-name').value || 'Ù†Ø§Ù…Ø´Ø®Øµ';
            const checkDate = document.getElementById('check-date').value || 'ØªØ§Ø±ÛŒØ® Ù†Ø§Ù…Ø´Ø®Øµ';
            const qcOfficer = document.getElementById('qc-officer').value || 'Ù†Ø§Ù…Ø´Ø®Øµ';
            const reportNumber = document.getElementById('report-number').value || 'Ø´Ù…Ø§Ø±Ù‡ Ù†Ø§Ù…Ø´Ø®Øµ';
            
            const data = {
                company: "Ø´Ø±Ú©Øª Ø¢ØªØ±Ø§ Ø·Ø¨ Ù‚ÙˆÙ…Ø³",
                labName: labName,
                checkDate: checkDate,
                qcOfficer: qcOfficer,
                reportNumber: reportNumber,
                samplers: []
            };
            
            const rows = document.querySelectorAll('#table-body tr');
            rows.forEach(row => {
                const inputs = row.querySelectorAll('input[data-field]');
                const sampler = {};
                
                inputs.forEach(input => {
                    if (input.type === 'checkbox') {
                        sampler[input.dataset.field] = input.checked;
                    } else {
                        sampler[input.dataset.field] = input.value;
                    }
                });
                
                data.samplers.push(sampler);
            });
            
            // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage
            localStorage.setItem('atratab_qc_data', JSON.stringify(data));
            
            // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ù…ÙˆÙÙ‚ÛŒØª
            alert(`âœ… Ú¯Ø²Ø§Ø±Ø´ Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒ Ø¨Ø§ Ø´Ù…Ø§Ø±Ù‡ ${reportNumber} Ø¨Ø±Ø§ÛŒ Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡ "${labName}" Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯.`);
            
            // Ù†Ù…Ø§ÛŒØ´ Ø®Ù„Ø§ØµÙ‡ Ú¯Ø²Ø§Ø±Ø´
            const passedCount = data.samplers.filter(s => s.finalOk === true).length;
            const totalCount = data.samplers.length;
            
            console.log('ğŸ“Š Ø®Ù„Ø§ØµÙ‡ Ú¯Ø²Ø§Ø±Ø´ Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒ:', {
                Ø´Ø±Ú©Øª: data.company,
                Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡: data.labName,
                ØªØ§Ø±ÛŒØ®: data.checkDate,
                'ØªØ¹Ø¯Ø§Ø¯ Ø³Ù…Ù¾Ù„Ø±Ù‡Ø§': totalCount,
                'ØªØ¹Ø¯Ø§Ø¯ Ù‚Ø§Ø¨Ù„ Ù‚Ø¨ÙˆÙ„': passedCount,
                'ØªØ¹Ø¯Ø§Ø¯ Ù…Ø±Ø¯ÙˆØ¯': totalCount - passedCount
            });
        }
        
        // ØªØ§Ø¨Ø¹ Ø®Ø±ÙˆØ¬ÛŒ Ø¨Ù‡ Ø§Ú©Ø³Ù„ (CSV)
        function exportToExcel() {
            const labName = document.getElementById('lab-name').value || 'Ù†Ø§Ù…Ø´Ø®Øµ';
            const checkDate = document.getElementById('check-date').value || 'ØªØ§Ø±ÛŒØ® Ù†Ø§Ù…Ø´Ø®Øµ';
            const reportNumber = document.getElementById('report-number').value || 'Ø´Ù…Ø§Ø±Ù‡ Ù†Ø§Ù…Ø´Ø®Øµ';
            
            // Ø§ÛŒØ¬Ø§Ø¯ ÛŒÚ© Ø±Ø´ØªÙ‡ CSV
            let csv = 'Ø´Ø±Ú©Øª Ø¢ØªØ±Ø§ Ø·Ø¨ Ù‚ÙˆÙ…Ø³ - Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒ ØªØ¬Ù‡ÛŒØ²Ø§Øª Ù¾Ø²Ø´Ú©ÛŒ Ùˆ Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡ÛŒ\n';
            csv += 'Ø¢Ø¯Ø±Ø³: Ø³Ù…Ù†Ø§Ù† - Ø¨Ù„ÙˆØ§Ø± 17 Ø´Ù‡Ø±ÛŒÙˆØ±ØŒ Ø¬Ù†Ø¨ Ø¯Ø§Ù†Ø´Ú©Ø¯Ù‡ Ø¯Ù†Ø¯Ø§Ù†Ù¾Ø²Ø´Ú©ÛŒØŒ Ù…Ø±Ú©Ø² Ø±Ø´Ø¯ ÙÙ†Ø§ÙˆØ±ÛŒ Ø³Ù„Ø§Ù…Øª\n';
            csv += `ØªÙ„ÙÙ†: 0910-032-1022 | Ø§ÛŒÙ…ÛŒÙ„: atra.teb@yahoo.com\n\n`;
            
            csv += `Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡: ${labName}\n`;
            csv += `ØªØ§Ø±ÛŒØ®: ${checkDate}\n`;
            csv += `Ø´Ù…Ø§Ø±Ù‡ Ú¯Ø²Ø§Ø±Ø´: ${reportNumber}\n\n`;
            
            csv += 'Ø±Ø¯ÛŒÙ,Ø³Ø±ÛŒØ§Ù„/Ù…Ø¯Ù„,Ø´Ù…Ø§Ø±Ù‡ Ø§Ù…ÙˆØ§Ù„,Ø­Ø¬Ù… Ù†Ø§Ù…ÛŒ (Âµl),ÙˆØ²Ù† Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† (mg),Ø­Ø¬Ù… Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒØ´Ø¯Ù‡ (Âµl),Ø¯Ù‚Øª (CV%),Ø­Ø¯ Ø¯Ù‚Øª (%),ØµØ­Øª (Ø§Ù†Ø­Ø±Ø§Ù%),Ø­Ø¯ ØµØ­Øª (%),ÙˆØ¶Ø¹ÛŒØª\n';
            
            const rows = document.querySelectorAll('#table-body tr');
            rows.forEach((row, index) => {
                const cells = row.cells;
                const rowNum = index + 1;
                const serial = cells[1].querySelector('input').value || '';
                const asset = cells[2].querySelector('input').value || '';
                const nominal = cells[3].querySelector('input').value || '';
                const weight = cells[4].querySelector('input').value || '';
                const calc = cells[5].querySelector('input').value || '';
                const precision = cells[6].querySelector('.precision-value').value || '';
                const precisionLimit = cells[6].querySelector('.precision-limit').value || '';
                const accuracy = cells[7].querySelector('.accuracy-value').value || '';
                const accuracyLimit = cells[7].querySelector('.accuracy-limit').value || '';
                const status = cells[8].querySelector('.final-status').checked ? 'Ù‚Ø§Ø¨Ù„ Ù‚Ø¨ÙˆÙ„' : 'Ù…Ø±Ø¯ÙˆØ¯';
                
                csv += `${rowNum},${serial},${asset},${nominal},${weight},${calc},${precision},${precisionLimit},${accuracy},${accuracyLimit},${status}\n`;
            });
            
            csv += `\nØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ø³Ù…Ù¾Ù„Ø±Ù‡Ø§: ${rows.length}\n`;
            csv += `ØªØ¹Ø¯Ø§Ø¯ Ù‚Ø§Ø¨Ù„ Ù‚Ø¨ÙˆÙ„: ${Array.from(rows).filter(r => r.querySelector('.final-status').checked).length}\n`;
            csv += `ØªØ¹Ø¯Ø§Ø¯ Ù…Ø±Ø¯ÙˆØ¯: ${Array.from(rows).filter(r => !r.querySelector('.final-status').checked).length}\n`;
            csv += `\nØ§Ù…Ø¶Ø§ Ù…Ø³Ø¦ÙˆÙ„ Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒ: _________________\n`;
            csv += `ØªØ§Ø±ÛŒØ®: ${checkDate}`;
            
            // Ø§ÛŒØ¬Ø§Ø¯ ÙØ§ÛŒÙ„ Ùˆ Ø¯Ø§Ù†Ù„ÙˆØ¯
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.href = url;
            link.download = `QC_Report_${reportNumber}_${checkDate.replace(/\//g, '-')}.csv`;
            link.click();
            
            URL.revokeObjectURL(url);
            
            alert('âœ… ÙØ§ÛŒÙ„ Ø®Ø±ÙˆØ¬ÛŒ Ø¨Ø§ ÙØ±Ù…Øª CSV Ø¢Ù…Ø§Ø¯Ù‡ Ø´Ø¯.');
        }
        
        // ØªØ§Ø¨Ø¹ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙØ±Ù…
        function resetForm() {
            if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ù‡Ù…Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ±Ù… Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯ØŸ')) {
                document.getElementById('lab-name').value = '';
                document.getElementById('qc-officer').value = '';
                document.getElementById('report-number').value = 'QC-1403-001';
                
                // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§ Ùˆ Ø§ÛŒØ¬Ø§Ø¯ Ù…Ø¬Ø¯Ø¯
                const tableBody = document.getElementById('table-body');
                tableBody.innerHTML = '';
                
                // Ø§ÛŒØ¬Ø§Ø¯ 3 Ø±Ø¯ÛŒÙ Ø§ÙˆÙ„ÛŒÙ‡
                for (let i = 1; i <= 3; i++) {
                    tableBody.innerHTML += createRow(i);
                }
                
                rowCounter = 3;
                
                // Ø§ØªØµØ§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§
                for (let i = 1; i <= rowCounter; i++) {
                    attachRowEvents(i);
                }
                
                alert('âœ… ÙØ±Ù… Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ù¾Ø§Ú© Ùˆ Ø¨Ù‡ Ø­Ø§Ù„Øª Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù‡ Ø´Ø¯.');
            }
        }
        
        // ØªØ§Ø¨Ø¹ ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ Ø¨Ù‡ Ø´Ù…Ø³ÛŒ (Ø³Ø§Ø¯Ù‡ Ø´Ø¯Ù‡)
        function getCurrentPersianDate() {
            const now = new Date();
            const options = { year: 'numeric', month: '2-digit', day: '2-digit' };
            return now.toLocaleDateString('fa-IR', options);
        }
        
        // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ ØµÙØ­Ù‡
        document.addEventListener('DOMContentLoaded', function() {
            // Ø§ÛŒØ¬Ø§Ø¯ 3 Ø±Ø¯ÛŒÙ Ø§ÙˆÙ„ÛŒÙ‡
            const tableBody = document.getElementById('table-body');
            for (let i = 1; i <= 3; i++) {
                tableBody.innerHTML += createRow(i);
            }
            
            // Ø§ØªØµØ§Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ Ø¨Ù‡ Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§
            for (let i = 1; i <= rowCounter; i++) {
                attachRowEvents(i);
            }
            
            // ØªÙ†Ø¸ÛŒÙ… ØªØ§Ø±ÛŒØ® Ø§Ù…Ø±ÙˆØ² Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø±
            const todayPersian = getCurrentPersianDate();
            document.getElementById('check-date').value = todayPersian;
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡
            const savedData = localStorage.getItem('atratab_qc_data');
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    
                    if (confirm('Ø¢ÛŒØ§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡ Ù‚Ø¨Ù„ÛŒ Ø±Ø§ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯ØŸ')) {
                        document.getElementById('lab-name').value = data.labName || '';
                        document.getElementById('check-date').value = data.checkDate || todayPersian;
                        document.getElementById('qc-officer').value = data.qcOfficer || '';
                        document.getElementById('report-number').value = data.reportNumber || 'QC-1403-001';
                    }
                } catch (e) {
                    console.log('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡');
                }
            }
        });
    </script>
</body>
</html>